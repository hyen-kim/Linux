================================================================================

13주차

04. 사용자 정보 관리 명령
05. 디스크 사용량(쿼터)설정

================================================================================

04. 사용자 정보 관리 명령

* UID와 EUID 
- UID(RUID)는 사용자가 로그인할 때 사용한 계정의 UID
- EUID는 현재 명령을 수행하는 주체의 UID
- 실행 파일에 setuid가 설정되어 있는 경우 : 
	-> 해당 실행 파일을 실행한 프로세스의 UID는 사용자 계정의 UID가 아니라 
	   실행 파일 소유자의 UID
	-> 이때 실행 파일 소유자의 UID가 EUID

- su 명령을 사용하여 다른 계정으로 전환한 경우 :
	-> 사용자가 로그인하면 처음에는 UID와 EUID가 같은 값을 가짐
	-> 하지만 su 명령을 사용하여 다른 사용자로 전환하면 UID와 EUID가 달라짐


* 사용자 로그인 정보 확인하기 : who
- 현재 시스템을 사용하는 사용자의 정보를 출력한다
- -q : 사용자명만 출력			--> 로그인한 사용자의 수와 계정 이름 출력
- -H : 출력 항목의 제목도 함께 출력	--> 각 항목의 제목 출력
- -b : 마지막으로 재부팅한 날짜와 시간을 출력	--> 마지막으로 부팅한 날짜와 시간 출력
- -m : 현재 사용자 계정의 정보를 출력
- -r : 현재 런레벨을 출력
- 옵션 없이 사용하면 사용자 이름, 사용자가 접속한 단말기 번호,
  로그인한 시간, 외부 네트워크에서 접속했을 경우 외부 컴퓨터 이름이나 IP 주소가 출력


* w명령
- 현재 시스템을 사용하는 사용자의 정보와 작업 정보를 출력
- w [사용자명]
- who 명령에서 나온 출력 외에 활동에 대한 정보와 CPU 사용량, 시스템 로드 정보 등이 추가로 출력


* last 명령
- 사용자의 이름과 로그인한 시간, 로그아웃한 시간, 터미널 번호나 IP 주소를 출력
- 시스템에 로그인하고 로그아웃한 정보를 출력
- 형식 : last 


* UID와 EUID 확인하기 : whoami, who am i, id
- UID 출력 : who am i, who -m
- EUID 출력 : whoami, id
ex) user1로 로그인한 경우 -> 모두 user1(1000)을 출력


* 소속 그룹 확인하기 : groups
- 사용자 계정이 속한 그룹을 출력
- 형식 : groups [계정명]
- 특별히 사용자를 지정하지 않고 groups 명령을 실행하면 현재 사용자 계정이 속한 그룹을 출력
- 사용자 계정을 인수로 지정하면 해당 사용자 계정이 속한 그룹 정보를 출력


* root 권한 사용하기 
- su 명령을 사용하여 root 계정으로 전환 : 모든 권한 부여
- sudo 명령 사용 : 특정 작업만 수행할 수 있는 권한만 부여


* sudo 권한 설정하기
- 권한부여 : /etc/sudoers 파일에 설정
  사용자 계정 	호스트 = 명령어
- root 계정의 경우 : 어디서나 어느 명령이든지 실행할 수 있음을 의미
  root 	ALL=(ALL)	ALL
- 특정 사용자에게 특정 명령을 수행할 권한을 부여할 경우 : user2에게 사용자 추가,
  수정 권한 부여한다면 명령은 절대 경로로, 명령이 여러 개 일 경우 쉼표로 구분
- sudo 명령 사용 시 암호를 입력하는 과정을 생략하려면 /etc/sudoers 파일에 다음과 같이 설정
  localhost=NOPASSD:/sbin/useradd, /sbin/usermod
* sudo 명령 사용 시 주의 사항
- 일반 사용자에게 모든 권한을 부여하는 것은 매우 위험
- 해당 사용자 계정의 암호가 유출되면 root 계정의 암호가 유출된 것이나 마찬가지이기 때문
- sudo 명령을 사용할 수 있는 사용자의 선정과 명령 선택은 매우 신중하게 처리해야 함


* passwd 명령 활용하기
- 사용자 계정의 암호를 수정
- passwd [옵션] [사용자 계정]
- -l 사용자 계정 : 지정한 계정의 암호를 잠금
- -u 사용자 계정 : 암호 잠금을 해제
- -d 사용자 계정 : 지정한 계정의 암호를 삭제


* 파일 및 디렉터리의 소유자와 소유 그룹 변경하기 
- 파일이나 디렉터리는 해당 파일이나 디렉터리를 생성한 사용자의 계정과 그룹이 소유자와 소유 그룹으로 설정
- 파일이나 디렉터리의 소유자를 변경할 필요가 있을 때 chown과 chgrp 명령을 사용

* chown 명령
- 파일이나 디렉터리의 소유자와 소유 그룹을 변경
- chown [옵션] [사용자 계정] [파일명/디렉터리명]
- -R : 서브 디렉터리의 소유자와 소유 그룹도 변경



* chgrp 명령
- 파일과 디렉터리의 소유 그룹을 변경
- chgrp [옵션] [사용자 계정] [파일명/디렉터리명]
- -R : 서브 디렉터리의 소유 그룹도 변경










05. 디스크 사용량(쿼터) 설정

* 디스크 쿼터 : 디스크 사용량을 제한하는 것
- 하드디스크에서 사용자가 사용할 수 있는 파일의 전체 용량을 설정하는 방법
- 사용자가 사용할 수 있는 총 파일 수로 설정하는 방법
- 하드 리미트는 사용자가 절대로 넘을 수 없는 최대치를 명시한 값
- 소프트 리미트는 일정 시간 내에는 넘을 수 있는 한계 값


* 쿼터 설정을 위한 사전 준비
- usrquota : 개별 사용자의 쿼터를 제한할 수 있는 속성
- grpquota : 개별 그룹의 쿼터를 제한할 수 있는 속성



* 쿼터 사용 활성화하기 : quotaon
- 파일 시스템의 쿼터 기능을 활성화 
- quotaon [옵션] [파일 시스템]
- -a : 전체 파일 시스템의 쿼터 기능을 활성화 
- -u : 사용자 쿼터를 활성화
- -g : 그룹 쿼터를 활성화
- -v : 명령 진행 상황을 상세하게 출력
- 루트 파일 시스템의 쿼터를 활성화하면 다음과 같은 메시지 출력
- 쿼터의 비활성화는 quotaoff 명령으로 실행



* 쿼터 설정하기 : edquota
- 쿼터를 설정
- edquota [옵션] [사용자 계정 또는 그룹명]
- -u : 사용자 쿼터를 설정
- -g : 그룹 쿼터를 설정
- -p : 쿼터 설정을 복사




* 쿼터 정보 확인하기 : quota
- 쿼터 정보 출력
- quota [옵션] [사용자 계정 또는 그룹명]
- -u : 사용자 쿼터 정보를 출력
- -g : 그룹 쿼터 정보를 출력



* 쿼터 정보 요약 출력하기 : repquota 
- 쿼터 정보를 요약하여 출력
- repquota [옵션] [파일 시스템]
- -a : 전체 파일 시스템의 쿼터 정보를 출력
- -v : 사용량이 없는 쿼터의 정보도 출력
- -u : 사용자 쿼터 정보를 출력
- -g : 그룹 쿼터 정보를 출력

